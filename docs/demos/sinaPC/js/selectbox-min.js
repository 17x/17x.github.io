/*! popupjs v1.0.0 | https://github.com/aui/popupjs */
!function(){function a(b){var d=c[b],e="exports";return"object"==typeof d?d:(d[e]||(d[e]={},d[e]=d.call(d[e],a,d[e],d)||d[e]),d[e])}function b(a,b){c[a]=b}var c={};b("jquery",function(){return jQuery}),b("popup",function(a){function b(){this.destroyed=!1,this.__popup=c("<div />").css({display:"none",position:"absolute",outline:0}).attr("tabindex","-1").html(this.innerHTML).appendTo("body"),this.__backdrop=this.__mask=c("<div />").css({opacity:.7,background:"#000"}),this.node=this.__popup[0],this.backdrop=this.__backdrop[0],d++}var c=a("jquery"),d=0,e=!("minWidth"in c("html")[0].style),f=!e;return c.extend(b.prototype,{node:null,backdrop:null,fixed:!1,destroyed:!0,open:!1,returnValue:"",autofocus:!0,align:"bottom left",innerHTML:"",className:"ui-popup",show:function(a){if(this.destroyed)return this;var d=this.__popup,g=this.__backdrop;if(this.__activeElement=this.__getActive(),this.open=!0,this.follow=a||this.follow,!this.__ready){if(d.addClass(this.className).attr("role",this.modal?"alertdialog":"dialog").css("position",this.fixed?"fixed":"absolute"),e||c(window).on("resize",c.proxy(this.reset,this)),this.modal){var h={position:"fixed",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",userSelect:"none",zIndex:this.zIndex||b.zIndex};d.addClass(this.className+"-modal"),f||c.extend(h,{position:"absolute",width:c(window).width()+"px",height:c(document).height()+"px"}),g.css(h).attr({tabindex:"0"}).on("focus",c.proxy(this.focus,this)),this.__mask=g.clone(!0).attr("style","").insertAfter(d),g.addClass(this.className+"-backdrop").insertBefore(d),this.__ready=!0}d.html()||d.html(this.innerHTML)}return d.addClass(this.className+"-show").show(),g.show(),this.reset().focus(),this.__dispatchEvent("show"),this},showModal:function(){return this.modal=!0,this.show.apply(this,arguments)},close:function(a){return!this.destroyed&&this.open&&(void 0!==a&&(this.returnValue=a),this.__popup.hide().removeClass(this.className+"-show"),this.__backdrop.hide(),this.open=!1,this.blur(),this.__dispatchEvent("close")),this},remove:function(){if(this.destroyed)return this;this.__dispatchEvent("beforeremove"),b.current===this&&(b.current=null),this.__popup.remove(),this.__backdrop.remove(),this.__mask.remove(),e||c(window).off("resize",this.reset),this.__dispatchEvent("remove");for(var a in this)delete this[a];return this},reset:function(){var a=this.follow;return a?this.__follow(a):this.__center(),this.__dispatchEvent("reset"),this},focus:function(){var a=this.node,d=this.__popup,e=b.current,f=this.zIndex=b.zIndex++;if(e&&e!==this&&e.blur(!1),!c.contains(a,this.__getActive())){var g=d.find("[autofocus]")[0];!this._autofocus&&g?this._autofocus=!0:g=a,this.__focus(g)}return d.css("zIndex",f),b.current=this,d.addClass(this.className+"-focus"),this.__dispatchEvent("focus"),this},blur:function(){var a=this.__activeElement,b=arguments[0];return b!==!1&&this.__focus(a),this._autofocus=!1,this.__popup.removeClass(this.className+"-focus"),this.__dispatchEvent("blur"),this},addEventListener:function(a,b){return this.__getEventListener(a).push(b),this},removeEventListener:function(a,b){for(var c=this.__getEventListener(a),d=0;d<c.length;d++)b===c[d]&&c.splice(d--,1);return this},__getEventListener:function(a){var b=this.__listener;return b||(b=this.__listener={}),b[a]||(b[a]=[]),b[a]},__dispatchEvent:function(a){var b=this.__getEventListener(a);this["on"+a]&&this["on"+a]();for(var c=0;c<b.length;c++)b[c].call(this)},__focus:function(a){try{this.autofocus&&!/^iframe$/i.test(a.nodeName)&&a.focus()}catch(b){}},__getActive:function(){try{var a=document.activeElement,b=a.contentDocument,c=b&&b.activeElement||a;return c}catch(d){}},__center:function(){var a=this.__popup,b=c(window),d=c(document),e=this.fixed,f=e?0:d.scrollLeft(),g=e?0:d.scrollTop(),h=b.width(),i=b.height(),j=a.width(),k=a.height(),l=(h-j)/2+f,m=382*(i-k)/1e3+g,n=a[0].style;n.left=Math.max(parseInt(l),f)+"px",n.top=Math.max(parseInt(m),g)+"px"},__follow:function(a){var b=a.parentNode&&c(a),d=this.__popup;if(this.__followSkin&&d.removeClass(this.__followSkin),b){var e=b.offset();if(e.left*e.top<0)return this.__center()}var f=this,g=this.fixed,h=c(window),i=c(document),j=h.width(),k=h.height(),l=i.scrollLeft(),m=i.scrollTop(),n=d.width(),o=d.height(),p=b?b.outerWidth():0,q=b?b.outerHeight():0,r=this.__offset(a),s=r.left,t=r.top,u=g?s-l:s,v=g?t-m:t,w=g?0:l,x=g?0:m,y=w+j-n,z=x+k-o,A={},B=this.align.split(" "),C=this.className+"-",D={top:"bottom",bottom:"top",left:"right",right:"left"},E={top:"top",bottom:"top",left:"left",right:"left"},F=[{top:v-o,bottom:v+q,left:u-n,right:u+p},{top:v,bottom:v-o+q,left:u,right:u-n+p}],G={left:u+p/2-n/2,top:v+q/2-o/2},H={left:[w,y],top:[x,z]};c.each(B,function(a,b){F[a][b]>H[E[b]][1]&&(b=B[a]=D[b]),F[a][b]<H[E[b]][0]&&(B[a]=D[b])}),B[1]||(E[B[1]]="left"===E[B[0]]?"top":"left",F[1][B[1]]=G[E[B[1]]]),C+=B.join("-")+" "+this.className+"-follow",f.__followSkin=C,b&&d.addClass(C),A[E[B[0]]]=parseInt(F[0][B[0]]),A[E[B[1]]]=parseInt(F[1][B[1]]),d.css(A)},__offset:function(a){var b=a.parentNode,d=b?c(a).offset():{left:a.pageX,top:a.pageY};a=b?a:a.target;var e=a.ownerDocument,f=e.defaultView||e.parentWindow;if(f==window)return d;var g=f.frameElement,h=c(e),i=h.scrollLeft(),j=h.scrollTop(),k=c(g).offset(),l=k.left,m=k.top;return{left:d.left+l-i,top:d.top+m-j}}}),b.zIndex=1024,b.current=null,b}),b("selectbox",function(a){function b(a,b){a=this.select=c(a),c.extend(this,b||{});var d=this,e=!("minWidth"in a[0].style);if(!a.is("[multiple]")){a.data("selectbox")&&a.data("selectbox").remove();var f=this._tpl(this.selectboxHtml,c.extend({textContent:d._getOption().html()||""},a.data()));this._selectbox=c(f),this._value=this._selectbox.find("[data-value]"),this.isShowDropdown&&!a.attr("disabled")&&(this._globalKeydown=c.proxy(this._globalKeydown,this),this._selectbox.on(this._clickType+" focus blur",function(a){d[d._clickType===a.type?"click":a.type]()})),this._selectbox.css({width:a.outerWidth()+"px"}),a.on("focus blur",function(a){d[a.type](),a.preventDefault()}).on("change",function(){var a=d._getOption().html();d._value.html(a)}),a.css({opacity:0,position:"absolute",left:e?"-9999px":"auto",right:"auto",top:"auto",bottom:"auto",zIndex:this.isShowDropdown?-1:1}).data("selectbox",this),a.after(this._selectbox)}}var c=a("jquery"),d=a("popup"),e="../css/ui-selectbox.css";if(e){var f=a[a.toUrl?"toUrl":"resolve"];f&&(e=f(e),e='<link rel="stylesheet" href="'+e+'" />',c("base")[0]?c("base").before(e):c("head").append(e))}var g=function(){};return g.prototype=d.prototype,b.prototype=new g,c.extend(b.prototype,{selectboxHtml:'<div class="ui-selectbox" hidefocus="true" style="user-select:none" onselectstart="return false" tabindex="-1" aria-hidden><div class="ui-selectbox-inner" data-value="">{{textContent}}</div><i class="ui-selectbox-icon"></i></div>',dropdownHtml:'<dl class="ui-selectbox-dropdown">{{options}}</dl>',optgroupHtml:'<dt class="ui-selectbox-optgroup">{{label}}</dt>',optionHtml:'<dd class="ui-selectbox-option {{className}}" data-option="{{index}}" tabindex="-1">{{textContent}}</dd>',selectedClass:"ui-selectbox-selected",disabledClass:"ui-selectbox-disabled",focusClass:"ui-selectbox-focus",openClass:"ui-selectbox-open",isShowDropdown:!("createTouch"in document),selectedIndex:0,value:"",close:function(){this._popup&&(this._popup.close().remove(),this.change())},show:function(){var a=this,b=this.select,e=a._selectbox;if(!b[0].length)return!1;var f=20,g=b.outerHeight(),h=b.offset().top-c(document).scrollTop(),i=c(window).height()-h-g,j=Math.max(h,i)-f,k=this._popup=new d;k.node.innerHTML=this._dropdownHtml(),this._dropdown=c(k.node),c(k.backdrop).css("opacity",0).on(this._clickType,c.proxy(this.close,this));var l=a._dropdown.children(),m=!("minWidth"in l[0].style);l.css({minWidth:e.innerWidth(),maxHeight:j,overflowY:"auto",overflowX:"hidden"}),this._dropdown.on(this._clickType,"[data-option]",function(b){var d=c(this).data("option");a.selected(d),a.close(),b.preventDefault()}),k.onshow=function(){c(document).on("keydown",a._globalKeydown),e.addClass(a.openClass),a.selectedIndex=b[0].selectedIndex,a.selected(a.selectedIndex)},k.onremove=function(){c(document).off("keydown",a._globalKeydown),e.removeClass(a.openClass)},this._oldValue=this.select.val(),k.showModal(e[0]),m&&(l.css({width:Math.max(e.innerWidth(),l.outerWidth()),height:Math.min(j,l.outerHeight())}),k.reset())},selected:function(a){if(this._getOption(a).attr("disabled"))return!1;var b=this._dropdown,c=this._dropdown.find("[data-option="+a+"]"),d=this.select[0].options[a].value,e=this.select[0].selectedIndex,f=this.selectedClass;return b.find("[data-option="+e+"]").removeClass(f),c.addClass(f),c.focus(),this._value.html(this._getOption(a).html()),this.value=d,this.selectedIndex=a,this.select[0].selectedIndex=this.selectedIndex,this.select[0].value=this.value,!0},change:function(){this._oldValue!==this.value&&this.select.triggerHandler("change")},click:function(){this.select.focus(),this._popup&&this._popup.open?this.close():this.show()},focus:function(){this._selectbox.addClass(this.focusClass)},blur:function(){this._selectbox.removeClass(this.focusClass)},remove:function(){this.close(),this._selectbox.remove()},_clickType:"onmousedown"in document?"mousedown":"touchstart",_getOption:function(a){return a=void 0===a?this.select[0].selectedIndex:a,this.select.find("option").eq(a)},_tpl:function(a,b){return a.replace(/{{(.*?)}}/g,function(a,c){return b[c]})},_dropdownHtml:function(){var a="",b=this,d=this.select,e=d.data(),f=0,g=function(d){d.each(function(){var d=c(this),g="";g=this.selected?b.selectedClass:this.disabled?b.disabledClass:"",a+=b._tpl(b.optionHtml,c.extend({value:d.val(),textContent:d.html(),index:f,className:g},d.data(),e)),f++})};return d.find("optgroup").length?d.find("optgroup").each(function(d){a+=b._tpl(b.optgroupHtml,c.extend({index:d,label:this.label},c(this).data(),e)),g(c(this).find("option"))}):g(d.find("option")),this._tpl(this.dropdownHtml,{options:a})},_move:function(a){var b=0,c=this.select[0].length-1,d=this.select[0].selectedIndex+a;d>=b&&c>=d&&(this.selected(d)||this._move(a+a))},_globalKeydown:function(a){var b;switch(a.keyCode){case 8:b=!0;break;case 9:case 27:case 13:this.close(),b=!0;break;case 38:this._move(-1),b=!0;break;case 40:this._move(1),b=!0}b&&a.preventDefault()}}),function(a,d){"select"===a.type?new b(a,d):c(a).each(function(){new b(this,d)})}}),window.selectbox=a("selectbox")}();