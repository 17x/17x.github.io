{"version":3,"sources":["App.js","controllers.js","directives.js","router.js","service.js"],"names":["myApp","angular","module","run","$templateCache","put","window","onresize","document","getElementsByTagName","style","fontSize","documentElement","body","clientWidth","arguments","callee","controller","$rootScope","$scope","$swipe","$location","$document","$animate","$timeout","$cookies","$interval","ngDialog","$http","console","log","point","BMap","Map","geolocation","Geolocation","getCurrentPosition","r","this","getStatus","BMAP_STATUS_SUCCESS","alert","geoc","Geocoder","getLocation","rs","addComp","addressComponents","city","get","then","suc","allCity","data","cities","i","j","cityname","replace","setCity","cityid","loadInfoList","open","template","plain","className","overlay","showClose","width","closeAll","enableHighAccuracy","allTag","blacklist","all","length","_curTag","_curTagName","nodeType","tagName","toLowerCase","indexOf","href","parentNode","removeChild","e","crc","getObject","isLogIn","undefined","localStorage","getItem","currentCity","Number","cityInfoOnHome","isShowCity","value","showCity","obj","expireDate","Date","setDate","getDate","putObject","expires","setItem","url","timer","splashTimer","$body","find","aViews","$on","event","toState","toParams","fromState","fromParams","group","groupEnd","cancel","name","removeClass","addClass","isShowBack","lastState","getElementById","display","setHeader","page","param","title","icon","headerTitle","handleSwipeLeft","index","path","handleSwipeRight","footerItems","itemName","srefLink","iconName","cates","error","updateHomeItem","Storage","aCategorysInHome","JSON","parse","getNewest","response","searchService","search","keywords","searchInput","catid","isShowFilter","mockDataIndex","searchData","searchMore","concat","logout","remove","FileUploader","uploader","autoUpload","queueLimit","isImage","item","type","slice","lastIndexOf","postSubmit","isShowPostCate","isShowPostCity","fromPage","postInfo","areaid","areaname","cate","cateid","expiretime","contact","cel","qq","content","curInfo","num","id","infoid","parseInt","Math","random","parentid","aImages","slides","tapImage","$event","oImgCover","element","hasClass","username","password","login","userpwd","text","directive","$anchorScroll","restrict","scope","isshowcity","postinfo","setcity","templateUrl","isshowarea","_this","scrollTo","yOffset","require","link","ele","attrs","upCtrl","areas","setArea","area","$q","cityinfoonhome","$window","helper","support","FileReader","CanvasRenderingContext2D","isFile","isObject","File","file","attributes","onLoadFile","img","Image","onload","onLoadImage","src","target","result","params","height","canvas","attr","getContext","drawImage","$eval","ngThumb","reader","readAsDataURL","closehandle","transclude","panes","doms","addPane","pane","isShowChildren","push","addDom","dom","switchPane","_index","forEach","a","offsetHeight","setCate","catname","config","$stateProvider","$urlRouterProvider","$locationProvider","html5Mode","otherwise","state","abstract","views","header@index","footer@index","content@index","service","d","defer","method","resolve","faild","reject","promise"],"mappings":"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","file":"index.min.js","sourcesContent":["// var myApp = angular.module('myApp', ['ngSanitize','ngAnimate', 'ui.router', 'ui.select','ngTouch']);\nvar myApp = angular.module('myApp', ['ngAnimate', 'ui.router', 'ngTouch', 'ngCookies', 'angular-carousel', 'ngDialog', 'angularFileUpload']);\n\n// 缓存模板\nmyApp.run([\"$templateCache\", function($templateCache) {\n    $templateCache.put('templateId1', 'tpls/search.html');\n    $templateCache.put('templateId2', 'tpls/category.html');\n    $templateCache.put('templateId3', 'tpls/userCenter.html');\n    $templateCache.put('templateId4', 'tpls/post.html');\n    $templateCache.put('templateId5', 'tpls/city.html');\n    $templateCache.put('templateId6', 'tpls/info.html');\n    $templateCache.put('templateId7', 'tpls/login.html');\n    $templateCache.put('templateId8', 'tpls/reg.html');\n    $templateCache.put('templateId9', 'tpls/mypost.html');\n    $templateCache.put('templateId10', 'tpls/report.html');\n}]);\n//开启rem\nwindow.onresize = (function() {\n    document.getElementsByTagName('html')[0].style.fontSize = (document.documentElement || document.body).clientWidth / 25 + \"px\";\n    return arguments.callee;\n})();","// 全局contrl\r\nmyApp.controller('myAppCtrl', [\"$rootScope\", \"$scope\", \"$swipe\", \"$location\", \"$document\", \"$animate\", \"$timeout\", \"$cookies\", \"$interval\", \"ngDialog\", \"$http\",\r\n    function($rootScope, $scope, $swipe, $location, $document, $animate, $timeout, $cookies, $interval, ngDialog, $http) {\r\n        console.log('*** 开始加载全局CTRL ***');\r\n        console.log('*** 绑定到$rootScope上的方法： ngDialog $timeout $location $http $cookies ***');\r\n\r\n        // 方便全局调用\r\n        $rootScope.$timeout = $timeout;\r\n        $rootScope.$location = $location;\r\n        $rootScope.$http = $http;\r\n        $rootScope.$cookies = $cookies;\r\n        $rootScope.ngDialog = ngDialog;\r\n\r\n        console.log('*** 运行简单的百度广告去除 ***');\r\n\r\n        // 百度地图API功能\r\n        (function() {\r\n            var map = new BMap.Map(\"baidumap\");\r\n            var point = {};\r\n            var geolocation = new BMap.Geolocation();\r\n\r\n            geolocation.getCurrentPosition(function(r) {\r\n                if (this.getStatus() == BMAP_STATUS_SUCCESS) {\r\n                    point = r.point;\r\n                } else {\r\n                    alert('failed' + this.getStatus());\r\n                }\r\n\r\n                var geoc = new BMap.Geocoder();\r\n                geoc.getLocation(point, function(rs) {\r\n                    var addComp = rs.addressComponents;\r\n                    //  console.log(addComp.province + \", \" + addComp.city + \", \" + addComp.district + \", \" + addComp.street + \", \" + addComp.streetNumber);\r\n                    console.log(addComp.city);\r\n\r\n                    $rootScope.$http.get('mock/cities/cities.json')\r\n                        .then(function(suc) {\r\n                            // console.log(suc.data.cities)\r\n                            var allCity = suc.data.cities;\r\n                            console.log(allCity)\r\n                            for (var i in allCity) {\r\n                                if (typeof allCity[i] === 'object') {\r\n                                    for (var j in allCity[i]) {\r\n                                        if (allCity[i][j].cityname === (addComp.city.replace('市', ''))) {\r\n                                            $rootScope.setCity({ cityname: addComp.city.replace('市', ''), cityid: allCity[i][j].cityid });\r\n                                            $rootScope.loadInfoList();\r\n                                        }\r\n                                        console.log(allCity[i][j].cityname)\r\n                                    }\r\n                                }\r\n                            }\r\n                            $rootScope.ngDialog.open({\r\n                                template: '<p>定位于' + addComp.city + '，自动切换至' + addComp.city.replace('市', '') + '站</p>',\r\n                                plain: true,\r\n                                className: 'ngdialog-theme-default',\r\n                                overlay: false,\r\n                                showClose: false,\r\n                                width: 'auto'\r\n                            });\r\n                            $rootScope.$timeout(function() {\r\n                                $rootScope.ngDialog.closeAll();\r\n                            }, 2000);\r\n                        }, function() {\r\n\r\n                        })\r\n\r\n\r\n                });\r\n            }, { enableHighAccuracy: true });\r\n        })();\r\n\r\n        /*反http拦截广告*/\r\n        var allTag = [],\r\n            blacklist = ['baidu', 'winyylg'];\r\n        $interval(function() {\r\n            allTag = document.all;\r\n            for (var i = 0; i < allTag.length; i++) {\r\n                var _curTag = allTag[i],\r\n                    _curTagName = _curTag.nodeType === 1 ? _curTag.tagName.toLowerCase() : 'noTag';\r\n\r\n                if ('aimgscriptiframe'.indexOf(_curTagName) !== -1) {\r\n                    try {\r\n                        if (blacklist.indexOf(_curTag.href) !== -1) {\r\n                            _curTag.parentNode.removeChild(_curTag);\r\n                        }\r\n                    } catch (e) {\r\n                        if (blacklist.indexOf(_curTag.crc) !== -1) {\r\n                            _curTag.parentNode.removeChild(_curTag);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }, 2000);\r\n        /*反http拦截广告结束*/\r\n\r\n        // 获取登录信息\r\n        // console.log($rootScope.$cookies)\r\n        if ($rootScope.$cookies.getObject('userInfo')) {\r\n            console.log('*** 进入页面时检测到cookie存在userInfo ***', $rootScope.$cookies.getObject('userInfo'));\r\n            $rootScope.isLogIn = true;\r\n        }\r\n        // 当前城市获取与与设置\r\n        // 判断localstorage\r\n        if (typeof(Storage) !== undefined && window.localStorage.getItem('cityid') && window.localStorage.getItem('cityname') !== undefined) {\r\n            $rootScope.currentCity = {\r\n                cityid: window.localStorage.getItem('cityid'),\r\n                cityname: window.localStorage.getItem('cityname')\r\n            };\r\n        } else {\r\n            console.log('*** 不支持localstorage或其内没有找到城市信息 ***');\r\n            // 判断cookies\r\n            if ($rootScope.$cookies.getObject('cityInfo')) {\r\n                $rootScope.currentCity = {\r\n                    cityname: $cookies.get('cityname'),\r\n                    cityid: $cookies.get('curCity')\r\n                };\r\n                console.log('*** 进入页面时检测到cookie存在cityInfo ***', $rootScope.$cookies.getObject('cityInfo'));\r\n\r\n            } else {\r\n                // 设置为总站\r\n                console.log('*** 城市设置为总站 ***');\r\n                $rootScope.currentCity = {\r\n                    cityid: '00',\r\n                    cityname: '总站'\r\n                };\r\n            }\r\n        }\r\n        /*获取home页infolist列表*/\r\n        $rootScope.loadInfoList = function() {\r\n            $http.get('mock/cities/city' + Number($rootScope.currentCity.cityid) + '/cityinfo.json')\r\n                .then(function(suc) {\r\n                    $rootScope.cityInfoOnHome = suc.data;\r\n                }, function(data) {\r\n                    console.log(data);\r\n                });\r\n        };\r\n        $rootScope.loadInfoList();\r\n        $scope.isShowCity = { value: false };\r\n        $scope.showCity = function() {\r\n            $scope.isShowCity = { value: true };\r\n        };\r\n        $rootScope.setCity = function(obj) {\r\n            console.log(obj);\r\n            $rootScope.currentCity = {\r\n                cityname: obj.cityname,\r\n                cityid: obj.cityid\r\n            };\r\n            // 更新cookies and storage\r\n            var expireDate = new Date();\r\n            // 过期时间为一天\r\n            expireDate.setDate(expireDate.getDate() + 1);\r\n\r\n            $rootScope.$cookies.putObject('cityInfo', {\r\n                cityid: obj.cityid,\r\n                cityname: obj.cityname\r\n            }, {\r\n                // path :'',\r\n                // domain :'127.0.0.1',\r\n                // secure: true,\r\n                expires: expireDate\r\n            });\r\n            window.localStorage.setItem('cityname', obj.cityname);\r\n            window.localStorage.setItem('cityid', obj.cityid);\r\n\r\n            //设置完成后重新加载infoList\r\n            $scope.isShowCity = { value: false };\r\n            $rootScope.loadInfoList();\r\n            $rootScope.$location.url('/home');\r\n        };\r\n\r\n        $scope.timer = null;\r\n        $scope.splashTimer = null;\r\n        var $body = $document.find('body');\r\n        var aViews = ['home', 'category', 'usercenter', 'post'];\r\n\r\n        //监听路由改变开始 添加动画\r\n        $scope.$on('$stateChangeStart', function(event, toState, toParams, fromState, fromParams) {\r\n            console.group();\r\n            console.log('*** 路由change开始 ***');\r\n            console.log('*** 本次路由change参数:', '\\n event:', event, '\\n toState:', toState, '\\n toParams:', toParams, '\\n fromState:', fromState, '\\n fromParams:', fromParams, ' ***');\r\n            console.groupEnd();\r\n\r\n            if ($rootScope.isLogIn && toState.url.indexOf('login') !== -1) {\r\n                console.log('请求前往login页面');\r\n                console.log('检测到已经登录,跳转至usercenter');\r\n                console.log('login位于toState.url的位置:', toState.url.indexOf('login'));\r\n                $rootScope.$location.url('/usercenter');\r\n            }\r\n\r\n            $timeout.cancel($scope.timer);\r\n            if (fromState.name !== \"\") {\r\n                $body.removeClass('fadeOutAndIn');\r\n                $body.removeClass('fadeInAndOutToRight');\r\n                if (aViews.indexOf(fromState.name) > aViews.indexOf(toState.name)) {\r\n                    // right to left\r\n                    $body.addClass('fadeInAndOutToRight');\r\n                } else if (aViews.indexOf(fromState.name) < aViews.indexOf(toState.name)) {\r\n                    // left to right\r\n                    $body.addClass('fadeOutAndIn');\r\n                } else {\r\n                    $body.addClass('fadeOutAndIn');\r\n                }\r\n\r\n                $scope.timer = $timeout(function() {\r\n                    // clearAll\r\n                    $body.removeClass('fadeOutAndIn');\r\n                    $body.removeClass('fadeInAndOutToRight');\r\n                }, 500);\r\n            }\r\n\r\n            //判断是否显示返回按钮\r\n            if (toState.name === 'home') {\r\n                $timeout(function() {\r\n                    $rootScope.isShowBack = false;\r\n                }, 500);\r\n            } else {\r\n                $rootScope.isShowBack = true;\r\n            }\r\n        });\r\n\r\n        //监听路由改变完成 添加动画\r\n        $scope.$on('$stateChangeSuccess', function(event, toState, toParams, fromState, fromParams) {\r\n\r\n            // 路由change完成后更新存储 but the login page\r\n            console.log('路由change完成，toState:', toState, '$location.url():', $location.url());\r\n            //上一页不为login页面\r\n            if (toState.name.indexOf('login') === -1) {\r\n                $rootScope.lastState = $location.url();\r\n            }\r\n\r\n            $timeout.cancel($scope.splashTimer);\r\n            // 关闭loading动画遮罩\r\n            $scope.splashTimer = $timeout(function() {\r\n                document.getElementById('splash').style.display = \"none\";\r\n            }, 1000);\r\n        });\r\n\r\n        $rootScope.setHeader = function(page, param) {\r\n            switch (page) {\r\n                case 'home':\r\n                    param = { title: '服装微加工', icon: 'icon-wjg-tb' };\r\n                    break;\r\n                case 'category':\r\n                    param = { title: '分类', icon: 'icon-iconfenlei' };\r\n                    break;\r\n                case 'usercenter':\r\n                    param = { title: '用户中心', icon: 'icon-icon iconfont icon-gerenzhongxin' };\r\n                    break;\r\n                case 'city':\r\n                    param = { title: '选择城市', icon: 'icon-wjg-dt' };\r\n                    break;\r\n                case 'post':\r\n                    param = { title: '发布信息', icon: 'icon-icon-fabu' };\r\n                    break;\r\n                case 'search':\r\n                    param = { title: '搜索', icon: 'icon-sousuo' };\r\n                    break;\r\n                case 'custom':\r\n                    param = param;\r\n                    break;\r\n                default:\r\n                    'home';\r\n                    break;\r\n            }\r\n\r\n            $timeout(function() {\r\n                $rootScope.headerTitle = param;\r\n            }, 200);\r\n        };\r\n        //滑动页面时的路由处理\r\n        $scope.handleSwipeLeft = function() {\r\n            var index = aViews.indexOf($location.path().replace('\\/', ''));\r\n            if (index === -1) {\r\n                return false;\r\n            }\r\n            if (index !== 3) {\r\n                // 往左滑动，页面往右+1\r\n                $location.path(aViews[index + 1]);\r\n            } else {\r\n                $location.path(aViews[0]);\r\n            }\r\n        };\r\n\r\n        $scope.handleSwipeRight = function() {\r\n            var index = aViews.indexOf($location.path().replace('\\/', ''));\r\n            if (index === -1) {\r\n                return false;\r\n            }\r\n            if (index !== 0) {\r\n                // 往左滑动，页面往右+1\r\n                $location.path(aViews[index - 1]);\r\n            } else {\r\n                $location.path(aViews[aViews.length - 1]);\r\n            }\r\n        };\r\n        // footer 四个item\r\n        $scope.footerItems = [{\r\n            itemName: \"首页\",\r\n            srefLink: \"home\",\r\n            iconName: \"icon-shouye\"\r\n        }, {\r\n            itemName: \"分类\",\r\n            srefLink: \"category\",\r\n            iconName: \"icon-iconfenlei\"\r\n        }, {\r\n            itemName: \"用户中心\",\r\n            srefLink: \"usercenter\",\r\n            iconName: \"icon-gerenzhongxin\"\r\n        }, {\r\n            itemName: \"发布\",\r\n            srefLink: \"post\",\r\n            iconName: \"icon-fabu\"\r\n        }];\r\n        // 获取所有分类\r\n        $rootScope.$http.get('mock/cates.json').then(function(suc) {\r\n            $rootScope.cates = suc.data;\r\n        }, function(error) {\r\n\r\n        });\r\n    }\r\n]);\r\n//  home页的content控制器\r\nmyApp.controller('homeCtrl', [\"$rootScope\", \"$scope\", \"updateHomeItem\", function($rootScope, $scope, updateHomeItem) {\r\n    // header中央的文字与图标初始化\r\n    $rootScope.setHeader('home');\r\n    // 为了在页面进入home时清除url参数\r\n    $rootScope.$location.url('home');\r\n    $rootScope.isShowBack = false;\r\n    // 获取首页八个大类信息\r\n    if ((typeof Storage) !== undefined && window.localStorage.aCategorysInHome) {\r\n        console.log('进入页面后找寻本地存储进行赋值');\r\n        $scope.aCategorysInHome = JSON.parse(window.localStorage.aCategorysInHome);\r\n        console.log($scope.aCategorysInHome);\r\n    }\r\n    // 通过service获取最新list\r\n    updateHomeItem.getNewest().then(function(response) {\r\n        if (response) {\r\n            $scope.aCategorysInHome = response.data;\r\n        }\r\n    }, function(error) {\r\n        console.log('获取错误');\r\n    });\r\n}]);\r\n\r\n// search 控制器\r\nmyApp.controller('searchCtrl', [\"$rootScope\", \"$scope\", \"searchService\", function($rootScope, $scope, searchService) {\r\n    // header中央的文字\r\n    $rootScope.setHeader('search');\r\n\r\n    // 进入search页面后为输入框添加url内的keywords\r\n    if ($rootScope.$location.search().keywords && $rootScope.$location.search().keywords.length) {\r\n        $rootScope.searchInput = $rootScope.$location.search().keywords;\r\n    }\r\n    if ($rootScope.$location.search().catid && $rootScope.$location.search().catid.length) {\r\n\r\n        // $scope.catid = $location.search().catid;\r\n    }\r\n    //提示没有远端数据\r\n    $rootScope.ngDialog.open({\r\n        template: '<p>本地没有对应分类信息</p><p>跳转至总分类</p>',\r\n        plain: true,\r\n        className: 'ngdialog-theme-default',\r\n        overlay: false,\r\n        showClose: false,\r\n        width: 'auto'\r\n    });\r\n    $rootScope.$timeout(function() {\r\n        $rootScope.ngDialog.closeAll();\r\n    }, 2000);\r\n\r\n    $scope.isShowFilter = true;\r\n    $scope.catid = 0;\r\n    //使用本地假数据\r\n    $rootScope.$location.search('catid', '0');\r\n    //当前获取次数\r\n    var mockDataIndex = 0;\r\n    searchService(mockDataIndex).then(function(suc) {\r\n        $scope.searchData = suc.data;\r\n    }, function() {\r\n\r\n    });\r\n    $scope.searchMore = function() {\r\n        ++mockDataIndex;\r\n        if (mockDataIndex === 9) {\r\n            mockDataIndex = 8;\r\n            console.log('mo more info ');\r\n            return false;\r\n        } else {\r\n            searchService(mockDataIndex).then(function(suc) {\r\n                $scope.searchData = $scope.searchData.concat(suc.data);\r\n            }, function() {\r\n\r\n            });\r\n        }\r\n    };\r\n\r\n}]);\r\n\r\n// category 控制器\r\nmyApp.controller('categoryCtrl', [\"$rootScope\", \"$scope\", function($rootScope, $scope) {\r\n    $rootScope.setHeader('category');\r\n\r\n}]);\r\n\r\n// usercenter 控制器\r\nmyApp.controller('usercenterCtrl', [\"$rootScope\", \"$scope\", function($rootScope, $scope) {\r\n    $rootScope.setHeader('usercenter');\r\n    if (!$rootScope.isLogIn) {\r\n        $rootScope.ngDialog.open({\r\n            template: '<p>请先登录！</p>',\r\n            plain: true,\r\n            className: 'ngdialog-theme-default',\r\n            overlay: false,\r\n            showClose: false,\r\n            width: 'auto'\r\n        });\r\n        $rootScope.$timeout(function() {\r\n            $rootScope.ngDialog.closeAll();\r\n        }, 2000);\r\n    }\r\n    $scope.logout = function() {\r\n        console.log($rootScope.$location);\r\n        $rootScope.$cookies.remove('userInfo');\r\n        $rootScope.isLogIn = false;\r\n    };\r\n}]);\r\n\r\n// post 控制器\r\nmyApp.controller('postCtrl', [\"$rootScope\", \"$scope\", \"FileUploader\", function($rootScope, $scope, FileUploader) {\r\n    $rootScope.setHeader('post');\r\n    //进入发布页面，判断是否登陆。\r\n    if (!$rootScope.isLogIn) {\r\n        $rootScope.ngDialog.open({\r\n            template: '<p>请先登录！</p>',\r\n            plain: true,\r\n            className: 'ngdialog-theme-default',\r\n            overlay: false,\r\n            showClose: false,\r\n            width: 'auto'\r\n        });\r\n        $rootScope.$timeout(function() {\r\n            $rootScope.ngDialog.closeAll();\r\n        }, 2000);\r\n\r\n        $rootScope.$location.path('/login');\r\n    }\r\n    $scope.uploader = new FileUploader({\r\n        url: \"127.0.0.1\",\r\n        autoUpload: !0,\r\n        queueLimit: 10\r\n    });\r\n    $scope.isImage = function(item) {\r\n        var type = '|' + item.type.slice(item.type.lastIndexOf('/') + 1) + '|';\r\n        return '|jpg|png|jpeg|bmp|gif|'.indexOf(type) !== -1;\r\n    };\r\n\r\n    function checkpostInfo() {\r\n\r\n    }\r\n    $scope.postSubmit = function() {\r\n        console.log($scope.uploader);\r\n        $rootScope.ngDialog.open({\r\n            template: '<p>发布没成功，因为没有对接后台。</p><p>3秒后跳转至用户中心</p>',\r\n            plain: true,\r\n            className: 'ngdialog-theme-default',\r\n            overlay: false,\r\n            showClose: false,\r\n            width: 'auto'\r\n        });\r\n        $rootScope.$timeout(function() {\r\n            $rootScope.ngDialog.closeAll();\r\n            $rootScope.$location.url('/usercenter');\r\n        }, 2000);\r\n    };\r\n    //发布页面显示类别选择面板\r\n    $scope.isShowPostCate = { value: false };\r\n    $scope.isShowPostCity = { value: false, fromPage: 'post' };\r\n\r\n    // 全部分类信息\r\n    $scope.cates = $rootScope.cates;\r\n    /*指令内部选择后的通道*/\r\n    $rootScope.postInfo = $scope.postInfo = {\r\n        areaid: '',\r\n        areaname: '',\r\n        cityid: '',\r\n        cityname: '',\r\n        cate: '',\r\n        cateid: '',\r\n        expiretime: '',\r\n        contact: '',\r\n        cel: '',\r\n        qq: '',\r\n        title: '',\r\n        content: ''\r\n    };\r\n}]);\r\n\r\n// info 控制器\r\nmyApp.controller('infoCtrl', [\"$rootScope\", \"$scope\", function($rootScope, $scope) {\r\n    // 进入info页面\r\n    $scope.curInfo = $rootScope.curInfo;\r\n    $rootScope.curInfo = null;\r\n\r\n    //非点击事件传入object\r\n    // 由url进入页面 \r\n    var num = 0;\r\n    if ($scope.curInfo) {\r\n        num = $scope.curInfo.id;\r\n    } else if (!$scope.curInfo && $rootScope.$location.search().infoid) {\r\n        //设置infoid对应obj的值\r\n        num = $rootScope.$location.search().infoid;\r\n    }\r\n    // 由于没有远端数据，对infoid做重定向处理\r\n    // min:53864 max:53914\r\n    if ($rootScope.$location.search().infoid < 53864 || $rootScope.$location.search().infoid > 53914) {\r\n        // 随机一个id\r\n        // alert(9)\r\n        if (!$rootScope.isLogIn) {\r\n            $rootScope.ngDialog.open({\r\n                template: '<p>假数据不存在，随机重定向</p>',\r\n                plain: true,\r\n                className: 'ngdialog-theme-default',\r\n                overlay: false,\r\n                showClose: false,\r\n                width: 'auto'\r\n            });\r\n            $rootScope.$timeout(function() {\r\n                $rootScope.ngDialog.closeAll();\r\n            }, 2000);\r\n        }\r\n        console.log(num, 'num is not in range');\r\n        num = parseInt(Math.random() * 49) + 53864;\r\n        console.log('随机分配infoid:', num);\r\n    }\r\n    $rootScope.$location.search('infoid', num);\r\n    // 获取对应id信息\r\n    $rootScope.$http.get('mock/infos/' + num + '.json').then(function(suc) {\r\n        $scope.curInfo = suc.data;\r\n        var icon = 'icon';\r\n        switch ($scope.curInfo.parentid) {\r\n            case 246:\r\n                icon = \"icon-waifajiagong\";\r\n                break;\r\n            case 264:\r\n                icon = \"icon-chengjiejiagong\";\r\n                break;\r\n            case 299:\r\n                icon = \"icon-shebeizurangweixiu\";\r\n                break;\r\n            case 309:\r\n                icon = \"icon-chengpinkucun\";\r\n                break;\r\n            case 323:\r\n                icon = \"icon-changfangzurang\";\r\n                break;\r\n            case 327:\r\n                icon = \"icon-mianfuliaogongqiu\";\r\n                break;\r\n            case 338:\r\n                icon = \"icon-zhaopin\";\r\n                break;\r\n            case 367:\r\n                icon = \"icon-qiuzhi\";\r\n                break;\r\n            default:\r\n                icon = \"icon-wjg-tb\";\r\n        }\r\n        $rootScope.setHeader('custom', { title: suc.data.title, icon: icon });\r\n\r\n    }, function(error) {\r\n\r\n    });\r\n\r\n\r\n    var aImages = [\r\n        [\"mock/img/pre_1484540313t64on.jpg\",\r\n            \"mock/img/pre_1484540343znkl1.JPEG\",\r\n            \"mock/img/pre_1484540364ineji.jpg\",\r\n            \"mock/img/pre_14845404071dgw4.jpg\"\r\n        ],\r\n        [\"mock/img/1484540313t64on.jpg\",\r\n            \"mock/img/1484540343znkl1.JPEG\",\r\n            \"mock/img/1484540364ineji.jpg\",\r\n            \"mock/img/14845404071dgw4.jpg\"\r\n        ]\r\n    ];\r\n    //使用第一组小图片提高速度\r\n    $scope.slides = aImages[0];\r\n\r\n    // 点击图片时全屏toggle\r\n    $scope.tapImage = function($event) {\r\n        var oImgCover = document.getElementById('imgCarouselCover');\r\n        if (angular.element(oImgCover).hasClass('fullscreen')) {\r\n            angular.element(oImgCover).removeClass('fullscreen');\r\n            $scope.slides = aImages[0];\r\n        } else {\r\n            angular.element(oImgCover).addClass('fullscreen');\r\n            $scope.slides = aImages[1];\r\n        }\r\n    };\r\n}]);\r\n// login 控制器\r\nmyApp.controller('loginCtrl', [\"$rootScope\", \"$scope\", function($rootScope, $scope) {\r\n\r\n    $rootScope.setHeader('custom', { title: '登录', icon: 'icon-icon iconfont icon-gerenzhongxin' });\r\n    /*测试用账号与密码*/\r\n    $scope.username = \"testUserName\";\r\n    $scope.password = \"testPassword\";\r\n    $scope.login = function() {\r\n        if ($scope.username === \"testUserName\" && $scope.password === \"testPassword\") {\r\n            //更新全局状态\r\n            $rootScope.isLogIn = true;\r\n\r\n            //设置cookies and localstorage\r\n            var expireDate = new Date();\r\n            // 过期时间为一天\r\n            expireDate.setDate(expireDate.getDate() + 1);\r\n            $rootScope.$cookies.putObject('userInfo', {\r\n                isLogIn: true,\r\n                username: $scope.username,\r\n                userpwd: $scope.password\r\n            }, {\r\n                // path :'',\r\n                // domain :'127.0.0.1',\r\n                // secure: true,\r\n                expires: expireDate\r\n            });\r\n\r\n            // 没有上一页信息\r\n            console.log($rootScope.lastState);\r\n            if (!$rootScope.lastState) {\r\n                //跳转至用户中心\r\n                $rootScope.$location.url('/usercenter');\r\n            } else {\r\n                $rootScope.$location.url($rootScope.lastState);\r\n            }\r\n        }\r\n    };\r\n}]);\r\n// report 控制器\r\nmyApp.controller('reportCtrl', [\"$rootScope\", \"$scope\", function($rootScope, $scope) {\r\n    $rootScope.setHeader('custom', { title: \"举报\", icon: \"icon-wjg-tb\" });\r\n    //未登录时跳转登录\r\n    if (!$rootScope.isLogIn) {\r\n        $rootScope.$location.url('/login');\r\n    }\r\n    $scope.text = \"hello world!!\";\r\n}]);\r\nmyApp.controller('regCtrl', [\"$rootScope\", \"$scope\", function($rootScope, $scope) {\r\n\r\n}]);\r\n","/*searchBar*/\r\nmyApp.directive('city', ['$rootScope', \"$anchorScroll\", function($rootScope, $anchorScroll) {\r\n    return {\r\n        restrict: 'AE',\r\n        // replace: true,\r\n        scope: {\r\n            isshowcity: '=',\r\n            postinfo: '=',\r\n            setcity: '&'\r\n        },\r\n        templateUrl: 'tpls/city.html',\r\n        controller: ['$scope', '$rootScope', function($scope, $rootScope) {\r\n            this.isshowcity = $scope.isshowcity;\r\n            this.city = $scope.city = $rootScope.currentCity;\r\n            this.postinfo = $scope.postinfo;\r\n\r\n            $scope.isshowarea = false;\r\n            console.log('开启地区选择面板');\r\n\r\n            //在post页面打开\r\n            if ($scope.isshowcity.fromPage === 'post') {\r\n                console.log('从post开启city指令');\r\n                if ($rootScope.currentCity.cityid === '00') {\r\n                    console.log('当前city为总站');\r\n\r\n                    $rootScope.$http.get('mock/cities/cities.json')\r\n                        .then(function(suc) {\r\n                            $scope.cities = suc.data;\r\n                        }, function(error) {});\r\n                    var _this = this;\r\n                    $scope.setcity = function(city) {\r\n                        if (city.cityid === '00') {\r\n                            return false;\r\n                        }\r\n                        console.log('选择了一个city：', city);\r\n                        _this.city = $scope.city = city;\r\n                        console.log('此时的city：', $scope.city);\r\n                        $scope.isshowarea = true;\r\n                    };\r\n                } else {\r\n\r\n                    // 已经选择了（非总站）城市\r\n                    //隐藏省市区选择块，显示区选择块\r\n                    $scope.isshowarea = true;\r\n                }\r\n\r\n            } else {\r\n                // 获取城市列表\r\n                $rootScope.$http.get('mock/cities/cities.json')\r\n                    .then(function(suc) {\r\n                        $scope.cities = suc.data;\r\n                    }, function(error) {});\r\n                // 当前为总站\r\n                // 用户点击head内的city选择\r\n                // 绑定全局城市设定函数\r\n                $scope.setcity = $rootScope.setCity;\r\n\r\n            }\r\n            //选择省份跳至对应区域\r\n            $scope.scrollTo = function(e) {\r\n                $anchorScroll.yOffset = 44;\r\n                $anchorScroll('province' + e);\r\n            };\r\n            /**/\r\n        }]\r\n    };\r\n}]);\r\nmyApp.directive('postarea', ['$rootScope', function($rootScope) {\r\n    return {\r\n        restrict: 'AE',\r\n        scope: {},\r\n        require: '^city',\r\n        template: '<div class=\"cities area\">请选择<span ng-bind=\"city.cityname\"></span>下的区：scope<ul><li ng-repeat=\"area in areas\"><a ng-click=setArea(area)>{{area.areaname}}</a></li></ul></div>',\r\n        link: function(scope, ele, attrs, upCtrl) {\r\n            scope.city = upCtrl.city;\r\n            console.log('加载了postarea');\r\n            console.log('此时的post city', scope.city);\r\n            console.log(upCtrl);\r\n\r\n            //无区数据的城市 105 唐山 206 大连\r\n            // 直接返回此城市名 关闭postcity\r\n            if (scope.city.cityid === '105' || scope.city.cityid === '206') {\r\n                alert('105 唐山 206 大连两个城市没有数据');\r\n                upCtrl.postinfo.cityid = scope.city.cityid;\r\n                upCtrl.postinfo.cityname = scope.city.cityname;\r\n                upCtrl.postinfo.areaname = scope.city.cityname;\r\n                upCtrl.isshowcity.value = false;\r\n            }\r\n            $rootScope.$http.get('mock/cities/city' + Number(scope.city.cityid) + '/allarea.json')\r\n                .then(function(suc) {\r\n                    scope.areas = suc.data.areas;\r\n                    console.log(suc.data.areas);\r\n                }, function(error) {});\r\n\r\n            scope.setArea = function(area) {\r\n                console.log(area);\r\n                console.log(upCtrl.isshowcity);\r\n                console.log('选择了一个area，关闭city选择面板');\r\n\r\n                upCtrl.postinfo.cityid = scope.city.cityid;\r\n                upCtrl.postinfo.cityname = scope.city.cityname;\r\n                upCtrl.postinfo.areaid = area.areaid;\r\n                upCtrl.postinfo.areaname = area.areaname;\r\n\r\n                console.log(upCtrl.postinfo);\r\n                upCtrl.isshowcity.value = false;\r\n            };\r\n        }\r\n    };\r\n}]);\r\n/*searchBar*/\r\nmyApp.directive('searchBar', ['$rootScope', function($rootScope) {\r\n    return {\r\n        restrict: 'AE',\r\n        require: '?search',\r\n        replace: true,\r\n        templateUrl: 'tpls/searchBar.html',\r\n        link: function(scope, ele, attrs, upCtrl) {\r\n            //serach input初始化\r\n            $rootScope.searchInput = '';\r\n        }\r\n    };\r\n}]);\r\n\r\n//首页的热门信息与最新信息指令\r\nmyApp.directive('infolist', ['$http', '$q', '$rootScope', function($http, $q, $rootScope) {\r\n    return {\r\n        restrict: 'AE',\r\n        replace: false,\r\n        scope: {\r\n            cityinfoonhome: '='\r\n        },\r\n        templateUrl: 'tpls/infoListOnHome.html',\r\n        link: function(scope) {\r\n            console.log(scope.cityInfoOnHome);\r\n        }\r\n    };\r\n}]);\r\n/*上传图片缩略显示*/\r\nmyApp.directive('ngThumb', ['$window', function($window) {\r\n    var helper = {\r\n        support: !!($window.FileReader && $window.CanvasRenderingContext2D),\r\n        isFile: function(item) {\r\n            return angular.isObject(item) && item instanceof $window.File;\r\n        },\r\n        isImage: function(file) {\r\n            var type = '|' + file.type.slice(file.type.lastIndexOf('/') + 1) + '|';\r\n            return '|jpg|png|jpeg|bmp|gif|'.indexOf(type) !== -1;\r\n        }\r\n    };\r\n\r\n    return {\r\n        restrict: 'A',\r\n        template: '<canvas/>',\r\n        link: function(scope, element, attributes) {\r\n            if (!helper.support) return;\r\n\r\n            var params = scope.$eval(attributes.ngThumb);\r\n\r\n            if (!helper.isFile(params.file)) return;\r\n            if (!helper.isImage(params.file)) return;\r\n\r\n            var canvas = element.find('canvas');\r\n            var reader = new FileReader();\r\n\r\n            reader.onload = onLoadFile;\r\n            reader.readAsDataURL(params.file);\r\n\r\n            function onLoadFile(event) {\r\n                var img = new Image();\r\n                img.onload = onLoadImage;\r\n                img.src = event.target.result;\r\n            }\r\n\r\n            function onLoadImage() {\r\n                var width = params.width || this.width / this.height * params.height;\r\n                var height = params.height || this.height / this.width * params.width;\r\n                canvas.attr({ width: width, height: height });\r\n                canvas[0].getContext('2d').drawImage(this, 0, 0, width, height);\r\n            }\r\n        }\r\n    };\r\n}]);\r\n\r\n/*post页面的cate选择*/\r\nmyApp.directive('catechoose', function() {\r\n    return {\r\n        restrict: 'AE',\r\n        replace: true,\r\n        scope: {\r\n            postinfo: '=',\r\n            closehandle: '='\r\n        },\r\n        transclude: true,\r\n        template: '<div ng-transclude></div>',\r\n        controller: [\"$scope\", function($scope) {\r\n            console.log('*** 打开post页面的分类选择面板指令', '*** ');\r\n            console.log('*** 此时表单信息为', $scope.postinfo, '***');\r\n\r\n            var panes = [];\r\n            var doms = [];\r\n\r\n            this.addPane = function(pane) {\r\n                pane.isShowChildren = false;\r\n                panes.push(pane);\r\n            };\r\n            this.addDom = function(dom) {\r\n                doms.push(dom);\r\n            };\r\n\r\n            this.switchPane = function(obj) {\r\n                /*关闭所有面板*/\r\n                var _index = panes.indexOf(obj);\r\n                console.log('处理开始：下标为', _index, obj.isShowChildren);\r\n                angular.forEach(panes, function(pane, index, a) {\r\n                    /*如果遍历至非当前点击对象下标*/\r\n                    /*或者当前点击对象为打开状态*/\r\n                    /*重置其面板为关闭高度*/\r\n                    if (index !== _index || obj.isShowChildren === true) {\r\n                        pane.isShowChildren = false;\r\n                        doms[index][0].style.height = \"42px\";\r\n                    } else {\r\n                        /*设为开启状态*/\r\n                        obj.isShowChildren = true;\r\n                        /*获取其子元素ul的高度并与head高度相加*/\r\n                        doms[_index][0].style.height = doms[_index].find('ul')[0].offsetHeight + 43 + 'px';\r\n                    }\r\n                });\r\n                console.log('处理完毕：下标为', _index, obj.isShowChildren);\r\n            };\r\n\r\n            /*点击赋值关闭指令*/\r\n            this.setCate = function(cate) {\r\n                console.log(\"点击了一个分类\", cate);\r\n                /*赋值*/\r\n                $scope.postinfo.cate = cate.catname;\r\n                $scope.postinfo.catid = cate.catid;\r\n                console.log('*** 此时表单信息为', $scope.postinfo, '***');\r\n                /*关闭指令*/\r\n                console.log('*** 关闭分类选择面板指令 ***');\r\n                $scope.closehandle.value = false;\r\n            };\r\n        }]\r\n    };\r\n});\r\n\r\nmyApp.directive('catechoosepane', ['$rootScope', function($rootScope) {\r\n    return {\r\n        restrict: 'AE',\r\n        replace: true,\r\n        transclude: true,\r\n        require: '^catechoose',\r\n        scope: {\r\n            cate: '='\r\n        },\r\n        link: function(scope, ele, attr, upCtrl) {\r\n            /*向上级指令传入scope与ele*/\r\n            upCtrl.addPane(scope);\r\n            upCtrl.addDom(ele);\r\n            /*开启switch通道*/\r\n            scope.switchPane = upCtrl.switchPane;\r\n\r\n            scope.setCate = upCtrl.setCate;\r\n\r\n        },\r\n        template: '<div class=\"cates\"><div class=\"catesHead\" ng-click=\"switchPane(this)\"><h1>{{cate.catname}}</h1><p>{{pane.isShowChildren}}</p></div><ul><li ng-repeat=\"a in cate.children\"><a ng-click=\"setCate(a)\">{{a.catname}}</a></li></ul></div>'\r\n    };\r\n}]);\r\n/*post页面的cate选择 end*/\r\n","myApp.config([\"$stateProvider\", \"$urlRouterProvider\", \"$locationProvider\", function($stateProvider, $urlRouterProvider, $locationProvider) {\n    $locationProvider.html5Mode(false);\n    // $locationProvider.hashPrefix()\n    $urlRouterProvider.otherwise('/home');\n\n    /*定义index abstract*/\n    $stateProvider\n        .state('index', {\n            abstract: true,\n            views: {\n                'header@index': { templateUrl: 'tpls/header.html' },\n                'footer@index': { templateUrl: 'tpls/footer.html' },\n                'content@index': {\n                    templateUrl: 'tpls/main.html'\n                }\n            }\n        })\n        /*home*/\n        .state('index.home', {\n            url: '/home',\n            'content@index': {\n                templateUrl: 'tpls/main.html'\n            }\n        })\n        /*search*/\n        .state('index.search', {\n            url: '/search?:keywords:catid',\n            views: {\n                'content@index': {\n                    controller: 'searchCtrl',\n                    templateUrl: 'tpls/search.html'\n                }\n            }\n        })\n        /*category*/\n        .state('index.category', {\n            url: '/category',\n            views: {\n                'content@index': {\n                    controller: 'categoryCtrl',\n                    templateUrl: 'tpls/category.html'\n                }\n            }\n        })\n        /*usercenter*/\n        .state('index.usercenter', {\n            url: '/usercenter',\n            views: {\n                'content@index': {\n                    controller: 'usercenterCtrl',\n                    templateUrl: 'tpls/userCenter.html'\n                }\n            }\n        })\n        /*post*/\n        .state('index.post', {\n            url: '/post',\n            views: {\n                'content@index': {\n                    controller: 'postCtrl',\n                    templateUrl: 'tpls/post.html'\n                }\n            }\n        })\n        /*info*/\n        .state('index.info', {\n            url: '/info?infoid',\n            views: {\n                'content@index': {\n                    controller: 'infoCtrl',\n                    templateUrl: 'tpls/info.html'\n                }\n            }\n        })\n        /*login*/\n        .state('index.login', {\n            url: '/login',\n            views: {\n                'content@index': {\n                    controller: 'loginCtrl',\n                    templateUrl: 'tpls/login.html'\n                }\n            }\n        })\n        /*register*/\n        .state('index.register', {\n            url: '/register',\n            views: {\n                'content@index': {\n                    controller: 'regCtrl',\n                    templateUrl: 'tpls/reg.html'\n                }\n            }\n        })\n        /*report*/\n        .state('index.report', {\n            url: '/report?infoid',\n            views: {\n                'content@index': {\n                    controller: 'reportCtrl',\n                    templateUrl: 'tpls/report.html'\n                }\n            }\n        })\n        /*mypost*/\n        .state('index.mypost', {\n            url: '/mypost',\n            views: {\n                'content@index': {\n                    templateUrl: 'tpls/mypost.html'\n                }\n            }\n        })\n         /*myfavor*/\n        .state('index.myfavor', {\n            url: '/mypost',\n            views: {\n                'content@index': {\n                    templateUrl: 'tpls/myfavor.html'\n                }\n            }\n        })\n         /*view history*/\n        .state('index.history', {\n            url: '/history',\n            views: {\n                'content@index': {\n                    templateUrl: 'tpls/history.html'\n                }\n            }\n        })\n        /*usersetting*/\n        .state('index.usersetting', {\n            url: '/usersetting',\n            views: {\n                'content@index': {\n                    templateUrl: 'tpls/usersetting.html'\n                }\n            }\n        })\n        /*contactus*/\n        .state('index.contactus', {\n            url: '/contactus',\n            views: {\n                'content@index': {\n                    templateUrl: 'tpls/contactus.html'\n                }\n            }\n        })\n        /*feedback*/\n        .state('index.feedback', {\n            url: '/feedback',\n            views: {\n                'content@index': {\n                    templateUrl: 'tpls/feedback.html'\n                }\n            }\n        });\n}]);\n","myApp.service('updateHomeItem', ['$http', '$q', function($http, $q) {\r\n    //获取最新list\r\n    this.getNewest = function() {\r\n        var d = $q.defer();\r\n        $http({\r\n                method: 'get',\r\n                url: 'mock/aCategorysInHome.json'\r\n            })\r\n            .then(function(suc) {\r\n                d.resolve(suc);\r\n            }, function(faild) {\r\n                d.reject(\"error\");\r\n            });\r\n\r\n        return d.promise;\r\n    };\r\n}]);\r\n\r\nmyApp.service('searchService', ['$http', '$q', function($http, $q) {\r\n    return function(mockDataIndex) {\r\n        var d = $q.defer();\r\n\r\n        $http.get('mock/search/cate' + mockDataIndex + '.json')\r\n            .then(function(suc) {\r\n                d.resolve(suc);\r\n            }, function() {\r\n                d.reject(\"error\");\r\n            })            \r\n        return d.promise;\r\n    }\r\n}]);\r\n"]}