var myApp=angular.module("myApp",["ngAnimate","ui.router","ngTouch","ngCookies","angular-carousel","ngDialog"]);myApp.run(["$templateCache",function(t){t.put("templateId1","tpls/search.html"),t.put("templateId2","tpls/category.html"),t.put("templateId3","tpls/usercenter.html"),t.put("templateId4","tpls/post.html")}]),window.onresize=function(){return document.getElementsByTagName("html")[0].style.fontSize=(document.documentElement||document.body).clientWidth/25+"px",arguments.callee}();
myApp.controller("myAppCtrl",["$rootScope","$scope","$swipe","$location","$document","$animate","$timeout","$cookies","$interval","ngDialog","$http",function(e,o,t,n,i,a,c,r,l,s,g){e.ngDialog=s,e.$timeout=c,e.$location=n,e.$http=g,e.$cookies=r;var m=[],d=["baidu","winyylg"];l(function(){m=document.all;for(var e=0;e<m.length;e++){var o=m[e],t=1===o.nodeType?o.tagName.toLowerCase():"noTag";if("aimgscriptiframe".indexOf(t)!==-1)try{d.indexOf(o.href)!==-1&&o.parentNode.removeChild(o)}catch(e){d.indexOf(o.crc)!==-1&&o.parentNode.removeChild(o)}}},2e3),e.searchInput="",void 0!==typeof Storage&&window.localStorage.getItem("cityid")&&window.localStorage.getItem("cityname")?e.currentCity={cityid:window.localStorage.getItem("cityid"),cityname:window.localStorage.getItem("cityname")}:(console.log(e.$cookies.getObject("cityInfo")),e.$cookies.getObject("cityInfo")?e.currentCity={cityname:r.get("cityname"),cityid:r.get("curCity")}:e.currentCity={cityid:"00",cityname:"总站"}),o.timer=null,o.splashTimer=null;var u=i.find("body"),p=["home","category","usercenter","post"];o.$on("$stateChangeStart",function(t,n,i,a,r){c.cancel(o.timer),""!==a.name&&(u.removeClass("fadeOutAndIn"),u.removeClass("fadeInAndOutToRight"),p.indexOf(a.name)>p.indexOf(n.name)?u.addClass("fadeInAndOutToRight"):p.indexOf(a.name)<p.indexOf(n.name)?u.addClass("fadeOutAndIn"):u.addClass("fadeOutAndIn"),o.timer=c(function(){u.removeClass("fadeOutAndIn"),u.removeClass("fadeInAndOutToRight")},500)),"home"===n.name?c(function(){e.isShowBack=!1},500):e.isShowBack=!0}),o.$on("$stateChangeSuccess",function(t,i,a,r,l){"login"!==i.name&&(e.lastState=n.url()),c.cancel(o.splashTimer),o.splashTimer=c(function(){document.getElementById("splash").style.display="none"},1e3)}),e.setHeader=function(o,t){switch(o){case"home":t={title:"服装微加工",icon:"icon-wjg-tb"};break;case"category":t={title:"分类",icon:"icon-iconfenlei"};break;case"usercenter":t={title:"用户中心",icon:"icon-icon iconfont icon-gerenzhongxin"};break;case"city":t={title:"选择城市",icon:"icon-wjg-dt"};break;case"post":t={title:"发布",icon:"icon-icon-fabu"};break;case"search":t={title:"搜索",icon:"icon-sousuo"};break;case"custom":t=t}c(function(){e.headerTitle=t},200)},o.handleSwipeLeft=function(){var e=p.indexOf(n.path().replace("/",""));return e!==-1&&void(3!==e?n.path(p[e+1]):n.path(p[0]))},o.handleSwipeRight=function(){var e=p.indexOf(n.path().replace("/",""));return e!==-1&&void(0!==e?n.path(p[e-1]):n.path(p[p.length-1]))},o.footerItems=[{itemName:"首页",srefLink:"home",iconName:"icon-shouye"},{itemName:"分类",srefLink:"category",iconName:"icon-iconfenlei"},{itemName:"用户中心",srefLink:"usercenter",iconName:"icon-gerenzhongxin"},{itemName:"发布",srefLink:"post",iconName:"icon-fabu"}]}]),myApp.controller("homeCtrl",["$rootScope","$scope","updateHomeItem",function(e,o,t){e.setHeader("home"),e.$location.url("home"),void 0!==typeof Storage&&window.localStorage.aCategorysInHome&&(console.log("进入页面后找寻本地存储进行赋值"),o.aCategorysInHome=JSON.parse(window.localStorage.aCategorysInHome),console.log(o.aCategorysInHome)),t.getNewest().then(function(e){e&&(o.aCategorysInHome=e.data)},function(e){console.log("获取错误")})}]),myApp.controller("searchCtrl",["$rootScope","$scope","searchService",function(e,o,t){e.setHeader("search"),e.$location.search().keywords&&e.$location.search().keywords.length&&(e.searchInput=e.$location.search().keywords),e.$location.search().catid&&e.$location.search().catid.length,e.ngDialog.open({template:"<p>本地没有对应分类信息</p><p>跳转至总分类</p>",plain:!0,className:"ngdialog-theme-default",overlay:!1,showClose:!1,width:"auto"}),e.$timeout(function(){e.ngDialog.closeAll()},2e3),o.isShowFilter=!0,o.catid=0,e.$location.search("catid","0");var n=0;t(n).then(function(e){o.searchData=e.data},function(){}),o.searchMore=function(){return++n,9===n?(n=8,console.log("mo more info "),!1):void t(n).then(function(e){o.searchData=o.searchData.concat(e.data)},function(){})}}]),myApp.controller("categoryCtrl",["$rootScope","$scope",function(e,o){e.setHeader("category"),e.$http.get("mock/cates.json").then(function(e){o.cates=e.data},function(e){})}]),myApp.controller("usercenterCtrl",["$rootScope","$scope",function(e,o){e.setHeader("usercenter"),e.isLogIn||(e.ngDialog.open({template:"<p>请先登录！</p>",plain:!0,className:"ngdialog-theme-default",overlay:!1,showClose:!1,width:"auto"}),e.$timeout(function(){e.ngDialog.closeAll()},2e3))}]),myApp.controller("postCtrl",["$rootScope","$scope",function(e,o){e.setHeader("post"),e.isLogIn||(e.ngDialog.open({template:"<p>请先登录！</p>",plain:!0,className:"ngdialog-theme-default",overlay:!1,showClose:!1,width:"auto"}),e.$timeout(function(){e.ngDialog.closeAll()},2e3),e.$location.path("/login"))}]),myApp.controller("cityCtrl",["$rootScope","$scope","$anchorScroll",function(e,o,t){e.setHeader("city"),e.$http.get("mock/cities/cities.json").then(function(e){o.cities=e.data},function(e){}),o.setCity=function(o){e.currentCity={cityname:o.cityname,cityid:o.cityid};var t=new Date;t.setDate(t.getDate()+1),e.$cookies.putObject("cityInfo",{cityid:o.cityid,cityname:o.cityname},{expires:t}),window.localStorage.setItem("cityname",o.cityname),window.localStorage.setItem("cityid",o.cityid),e.$location.path("/home")},o.scrollTo=function(e){t.yOffset=44,t("province"+e)}}]),myApp.controller("infoCtrl",["$rootScope","$scope",function(e,o){o.curInfo=e.curInfo,e.curInfo=null;var t=0;o.curInfo?t=o.curInfo.id:!o.curInfo&&e.$location.search().infoid&&(t=e.$location.search().infoid),(e.$location.search().infoid<53864||e.$location.search().infoid>53914)&&(e.isLogIn||(e.ngDialog.open({template:"<p>假数据不存在，随机重定向</p>",plain:!0,className:"ngdialog-theme-default",overlay:!1,showClose:!1,width:"auto"}),e.$timeout(function(){e.ngDialog.closeAll()},2e3)),console.log(t,"num is not in range"),t=parseInt(49*Math.random())+53864,console.log("随机分配infoid:",t)),e.$location.search("infoid",t),e.$http.get("mock/infos/"+t+".json").then(function(t){o.curInfo=t.data;var n="icon";switch(o.curInfo.parentid){case 246:n="icon-waifajiagong";break;case 264:n="icon-chengjiejiagong";break;case 299:n="icon-shebeizurangweixiu";break;case 309:n="icon-chengpinkucun";break;case 323:n="icon-changfangzurang";break;case 327:n="icon-mianfuliaogongqiu";break;case 338:n="icon-zhaopin";break;case 367:n="icon-qiuzhi";break;default:n="icon-wjg-tb"}e.setHeader("custom",{title:t.data.title,icon:n})},function(e){});var n=[["mock/img/pre_1484540313t64on.jpg","mock/img/pre_1484540343znkl1.JPEG","mock/img/pre_1484540364ineji.jpg","mock/img/pre_14845404071dgw4.jpg"],["mock/img/1484540313t64on.jpg","mock/img/1484540343znkl1.JPEG","mock/img/1484540364ineji.jpg","mock/img/14845404071dgw4.jpg"]];o.slides=n[0],o.tapImage=function(e){var t=document.getElementById("imgCarouselCover");angular.element(t).hasClass("fullscreen")?(angular.element(t).removeClass("fullscreen"),o.slides=n[0]):(angular.element(t).addClass("fullscreen"),o.slides=n[1])}}]),myApp.controller("loginCtrl",["$rootScope","$scope",function(e,o){e.setHeader("custom",{title:"登录",icon:"icon-icon iconfont icon-gerenzhongxin"}),o.username="testUserName",o.password="testPassword",o.login=function(){if("testUserName"===o.username&&"testPassword"===o.password){e.isLogIn=!0;var t=new Date;t.setDate(t.getDate()+1),e.$cookies.putObject("userInfo",{isLogIn:!0,otherInfo:"none"},{expires:t}),void 0!==typeof Storage&&window.localStorage.getItem("cityid")&&window.localStorage.getItem("cityname")&&window.localStorage.setItem("isLogIn",!0),e.lastState?e.$location.url(e.lastState):e.$location.url("usercenter")}}}]),myApp.controller("reportCtrl",["$rootScope","$scope",function(e,o){e.setHeader("custom",{title:"举报",icon:"icon-wjg-tb"}),e.isLogIn||e.$location.url("/login")}]);
myApp.directive("searchBar",["$rootScope","$location","$templateCache",function(t,e,o){return{restrict:"AE",require:"?search",replace:!0,templateUrl:"tpls/searchBar.html",link:function(t,e,o,n){}}}]),myApp.directive("infolist",["$http","$q","$rootScope",function(t,e,o){return{restrict:"AE",replace:!1,scope:{},templateUrl:"tpls/infoListOnHome.html",link:function(e){e.toInfoPage=o.toInfoPage,t.get("mock/cities/"+Number(o.currentCity.cityid)+"/cityinfo.json").then(function(t){e.cityInfoOnHome=t.data},function(t){console.log(t)})}}}]);
myApp.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){o.html5Mode(!1),t.otherwise("home");var r={templateUrl:"index.html"},l={templateUrl:"tpls/header.html"},h={templateUrl:"tpls/footer.html"};e.state("home",{url:"/home",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/main.html"}}}).state("search",{url:"/search?:keywords:catid",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/search.html"}}}).state("category",{url:"/category",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/category.html"}}}).state("usercenter",{url:"/usercenter",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/userCenter.html"}}}).state("post",{url:"/post",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/post.html"}}}).state("city",{url:"/city",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/city.html"}}}).state("info",{url:"/info?infoid",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/info.html"}}}).state("login",{url:"/login",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/login.html"}}}).state("register",{url:"/register",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/reg.html"}}}).state("report",{url:"/report?infoid",views:{"":r,"header@home":l,"footer@home":h,"content@home":{templateUrl:"tpls/report.html"}}})}]);
myApp.service("updateHomeItem",["$http","$q",function(e,r){this.getNewest=function(){var t=r.defer();return e({method:"get",url:"mock/aCategorysInHome.json"}).then(function(e){t.resolve(e)},function(e){t.reject("error")}),t.promise}}]),myApp.service("searchService",["$http","$q",function(e,r){return function(t){var n=r.defer();return e.get("mock/search/cate"+t+".json").then(function(e){n.resolve(e)},function(){n.reject("error")}),n.promise}}]);
//# sourceMappingURL=index.min.js.map
